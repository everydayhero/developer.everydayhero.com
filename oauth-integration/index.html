<!DOCTYPE HTML>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>everydayhero API: OAuth Integration</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/png" href="//experience.everydayhero.do/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="//experience.everydayhero.do/favicon-16x16.png" sizes="16x16">
  <link rel="mask-icon" href="//experience.everydayhero.do/safari-pinned-tab.svg" color="#1bab6b">
  <link rel="apple-touch-icon" sizes="180x180" href="//experience.everydayhero.do/apple-touch-icon.png">
  <link rel="stylesheet" href="/stylesheets/pygments.css">
  <link rel="stylesheet" href="/stylesheets/app.css">
  <!--[if lt IE 9]>
    <script src="/javascripts/html5shiv-printshiv.js"></script>
  <![endif]-->
  <script src="https://use.typekit.net/tek7gvp.js"></script>
  <script>try{Typekit.load({ async: true });}catch(e){}</script>
</head>
<body id=''>
  <header class="header top a--100">
    <a class='header-logo' href="/" title='Everydayhero Developer Documention'><h1>Everydayhero: Developer</h1></a>
  </header>
  <section class="main center">
    <aside class="l--30 m--100 left side-bar">
      <div class="inner">
        <nav>
            <div id='internal_api'>
              <ul>
                <li><a href="/internal/">Internal API</a>
                  <ul>
                    <li><a href="/internal/campaign-groups/">Campaign Groups</a></li>
                    <li><a href="/internal/charities/">Charities</a></li>
                    <li><a href="/internal/campaigns/">Campaigns</a></li>
                    <li><a href="/internal/registered-applications/">Registered Applications</a></li>
                  </ul>
                </li>
              </ul>
            </div>
            <div id='partner_api'>

              <ul>
                <li><a href="/partner/">Partner API</a>
                  <ul>
                    <li><a href="/partner/custom-authentication/">Custom Authentication</a></li>
                    <li><a href="/partner/feed/">Activity Feed</a></li>
                  </ul>
                </li>
              </ul>
            </div>
          <ul>
            <li><a href="/">Introduction</a></li>
            <li>
              <a href="/overview/">Overview</a>
              <ul id='menu_overview'>
                <li><a href="/overview/#environments">Environments</a></li>
                <li><a href="/overview/#schema">Schema</a></li>
                <li><a href="/overview/#parameters">Parameters</a></li>
                <li><a href="/overview/#auth-errors">Auth Errors</a></li>
                <li><a href="/overview/#validation-errors">Validation Errors</a></li>
                <li><a href="/overview/#http-verbs">HTTP Verbs</a></li>
                <li><a href="/overview/#pagination">Pagination</a></li>
                <li><a href="/overview/#caching">Caching</a></li>
                <li><a href="/rate-limits/">Rate limits</a></li>
                <li><a href="/glossary/">Glossary</a></li>
              </ul>
            </li>
            <li><a href="/authentication/">Authentication</a></li>


            <li class='title'>Resources</li>
            <li><a href="/campaigns/">Campaigns</a></li>
            <li> - <a href="/campaign-groups/">Groups</a></li>
            <li><a href="/charities/">Charities</a></li>

            <li><a href="/metadata/">Metadata</a></li>
            <li><a href="/pages/">Pages</a></li>
            <li> - <a href="/fitness-activities/">Fitness Activities</a></li>
            <li> - <a href="/posts/">Posts</a></li>
            <li>
              <a href="/teams/">Teams</a>
              <ul id='menu_teams'>
                <li><a href="/invitations/">Invitations</a>
                  <ul>
                    <li><a href="/invitations/#create-individual-page-invitation">Individual Page</a></li>
                    <li><a href="/invitations/#create-join-a-team-invitation">Join Team Invitation</a></li>
                  </ul>
                </li>
                <li><a href="/join-requests/">Join Requests</a></li>
                <li><a href="/members/">Members</a></li>
              </ul>
            </li>
            <li><a href="/users/">Users</a></li>
            <li class='title'>Leaderboards</li>
            <li><a href="/leaderboards/">Static Page Leaderboards</a></li>
            <li><a href="/dynamic-leaderboards/">Dynamic Page Leaderboards</a></li>
            <li><a href="/search-fitness-activities/">Fitness Activity Leaderboards</a></li>
            <li class='title'>Search &amp; Totals</li>
            <li><a href="/search/">Search</a></li>
            <li><a href="/totals/">Totals</a></li>

            <li class='title'>Integration Overviews</li>
            <li><a href="/oauth-integration/">OAuth Integration</a></li>
            <li><a href="/notifications/">Alerts/Notifications</a></li>
            <li><a href="/webhooks/">Webhooks</a></li>
            <li><a href="/third-party-registration-integration/">Registration Integration</a></li>
            <li class='title'>Client side Examples</li>
            <li>Totals
              <ul>
                <li><a href="/client-side/campaign-totals/">Campaign totals</a></li>
                <li><a href="/client-side/page-total/">Page totals</a></li>
              </ul>
            </li>
            <li><a href="/widgets/">Widgets</a></li>
          </ul>
        </nav>
      </div>
    </aside>
    <section class="l--70 m--100 right content">
      <div class="inner">
        
          <h1>OAuth Integration</h1>
          
<ul id="markdown-toc">
  <li><a href="#how-to-authenticate-with-edh">How to Authenticate with EDH</a></li>
  <li><a href="#creating-an-oauth-application">Creating an OAuth Application</a></li>
  <li><a href="#oauth-integration-libraries">OAuth Integration Libraries</a></li>
  <li><a href="#authentication-endpoints">Authentication endpoints</a></li>
  <li><a href="#token-endpoint">Token endpoint</a></li>
  <li><a href="#single-sign-on-to-everydayhero">Single Sign On to Everydayhero</a></li>
  <li><a href="#registration-product-integration">Registration Product Integration</a></li>
</ul>

<h2 id="how-to-authenticate-with-edh">How to Authenticate with EDH</h2>

<p>everydayhero’s OAuth account is our way of globally recognising a
user within any one of our products. We are now opening this
functionality for other developers to leverage. We are using the same
technology that powers Twitter and Facebook: OAuth2. You can get started with your own 
OAuth application below.</p>

<h2 id="creating-an-oauth-application">Creating an OAuth Application</h2>

<p>You can create your own OAuth app by creating an OAuth app and going to:</p>

<p><a href="http://everydayhero.com/developers/oauth_applications">Manage API Applications at everydayhero.com/developers</a></p>

<p>This application will give you access to all OAuth scoped endpoints. If you 
require access to authenticated non-OAuth calls, please contact 
<a href="mailto:api@everydayhero.com">Professional Services</a> for
credentials.</p>

<p>By default new applications require an Authorization screen, shown below.
Similar to other OAuth applications (Twitter, Facebook etc), this allows users
to either accept the connection or Deny.
<img src="/images/permission.png" alt="Authorization Screen"></p>

<p>If your integration requires the authorization screen to be skipped, contact 
<a href="mailto:api@everydayhero.com">Professional Services</a> and
the application will be reviewed.</p>

<h2 id="oauth-integration-libraries">OAuth Integration Libraries</h2>

<p>Integrating OAuth2 into any modern system should be fairly simple.
everydayhero have written (and maintain) the ruby client for
interfacing with the EDH OAuth accounts and it can be found on
<a href="https://github.com/everydayhero/omniauth-passport">GitHub</a>. A quick
google for your language / framework and OAuth2 should yield the best
library for you.</p>

<p>Various clients for supporting OAuth 2 in your language of choice are
available at <a href="http://oauth.net/2/">http://oauth.net/2/</a>.</p>

<p>By authenticating with the EDH OAuth account you are guaranteed that the
user you are dealing with will be the same person that is represented
in any everydayhero product.</p>

<h2 id="authentication-endpoints">Authentication endpoints</h2>

<p>Ideally your library of choice will handle the following for you, however 
if you would like to make use of the custom parameters, see the endpoints below.</p>

<h3 id="authorize-endpoint">Authorize endpoint</h3>

<pre><code>GET    https://passport.everydayhero.com/oauth/authorize(.:format)
</code></pre>

<p>The authorization endpoint is defined in the OAuth 2.0 specification
and is used by OAuth to interact with resource owners, authenticate
them, and obtains their authorization. An OAuth client makes an
authorization request by directing the user to the authorization endpoint.
After completing its interaction with the user, the OAuth
service redirects the user back to the client’s redirect URI with the
response to the authorization request.</p>

<h4 id="example">Example:</h4>
<pre><code>https://passport.everydayhero.com/oauth/authorize?response_type=code&amp;client_id=XXXX&amp;redirect_uri=http://MYAPP.COM/auth/passport/callback&amp;email=john@smith.com
</code></pre>

<h4 id="parameters">Parameters</h4>

<p>response_type : <em>required</em> <strong>string</strong><br>
A value of code results in the Authorization Code grant type while a value of token implies the Implicit grant type.</p>

<p>The recommended response_type is token, which requires using the Token endpoint to fetch the user Bearer Token after returning an auth code. However, if you are developing a client side application, use the response_type of code, this will return a Bearer Token in the URL hash of the redirect_uri provided.</p>

<p>client_id : <em>required</em> <strong>string</strong><br.></br.>
The client identifier.</p>

<p>redirect_uri : <em>optional</em> <strong>string</strong><br>
If present, the requested redirect_uri must match the one configured for the client. if the redirect_uri is set to <code>urn:ietf:wg:oauth:2.0:oob</code>, this will tell EDH to display the authorization code instead of redirecting to a client application (if this is still under development).</p>

<p>force : <em>optional</em> <strong>boolean</strong><br>
If set as true, this will force the user to sign up/sign in. If this is not set, and a user is signed in, the user will automatically continue their OAuth flow without requiring sign in.</p>

<h4 id="prepopulation">Prepopulation</h4>

<p>These parameters will be pre-populated on the sign up/in screen.</p>

<p>email : <em>optional</em> <strong>string</strong><br>
The email of the person you want to prepopulate the sign-up form for.</p>

<p>phone : <em>optional</em> <strong>string</strong><br>
The phone number of the person you want to prepopulate the sign-up form for.</p>

<p>name : <em>optional</em> <strong>string</strong><br>
The full name of the person you want to prepopulate the sign-up form for.</p>

<p>login_action : <em>optional</em> <strong>string</strong><br>
Set it to <code>sign-in</code> to be redirected to the sign-in form instead of the regular sign-up form.</p>

<h4 id="branding">Branding</h4>

<p>Branding is optional.</p>

<p>These parameters are only required if you would like branding from your campaign to be used for the sign up/in screen. If you choose to implement branding, both parameters are required.</p>

<p>reference : <em>optional</em> <strong>string</strong><br>
The campaign slug for the campaign which should be used for branding the login screen.</p>

<p>country : <em>optional</em> <strong>string</strong><br>
The country code associated with your campaign (au, nz, uk).</p>

<h4 id="response">Response</h4>

<pre class="highlight"><code class="language-javascript"><span class="p">{</span>
  <span class="s2">"code"</span><span class="o">:</span> <span class="s2">"a1d74c4c1d137662fdf69615b825e4c83fa02e25"</span>
<span class="p">}</span></code></pre>

<h2 id="token-endpoint">Token endpoint</h2>

<pre><code>POST   https://passport.everydayhero.com/oauth/token
</code></pre>

<p>The token endpoint is the endpoint on the authorization server where the
client application exchanges the authorization code, client ID and client
secret, for an access token.</p>

<h4 id="example-1">Example:</h4>
<pre><code>POST https://passport.everydayhero.com/oauth/token?code=CODE&amp;client_id=XXXX&amp;client_secret=XXXX&amp;grant_type=authorization_code&amp;redirect_uri=http://myapp.com:3000/auth/passport/callback
</code></pre>

<h3 id="parameters-1">Parameters</h3>

<p>grant_type : <em>required</em> <strong>string</strong><br>
Use authorization_code.</p>

<p>client_id : <em>required</em> <strong>string</strong><br>
The client identifier.</p>

<p>client_secret : <em>required</em> <strong>string</strong><br>
The client secret.</p>

<p>code : <em>required</em> <strong>string</strong><br>
The code returned from authorize endpoint.</p>

<p>redirect_uri : <em>required</em> <strong>string</strong><br>
The requested redirect_uri must match the one configured for the client.</p>

<h3 id="response-1">Response</h3>

<pre class="highlight"><code class="language-javascript"><span class="p">{</span>
  <span class="s2">"access_token"</span><span class="o">:</span> <span class="s2">"xxxxxxca4e6d9d09f1d6b1330ccf97d862a7b42e87c737195f90e508d0xxxxxx"</span><span class="p">,</span>
  <span class="s2">"token_type"</span><span class="o">:</span> <span class="s2">"bearer"</span><span class="p">,</span>
  <span class="s2">"expires_in"</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
  <span class="s2">"refresh_token"</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
  <span class="s2">"scope"</span><span class="o">:</span> <span class="s2">""</span>
<span class="p">}</span></code></pre>

<h2 id="single-sign-on-to-everydayhero">Single Sign On to Everydayhero</h2>

<p class="info"><strong>Authentication types</strong>: OAuth User Token </p>

<p>After the OAuth Flow, a Third party application obtains a token to perform some changes on behalf of a user.
E.g: create a Supporter Page.</p>

<p>However, by default this user is not authenticated on Everydayhero’s website. A third party application can create a form which posts at the URL below to sign the user in Everydayhero before to redirect them.</p>

<pre><code>POST https://everydayhero.com/api/v2/authentication/sessions
</code></pre>

<h3 id="payload">Payload</h3>

<p>access_token : <em>required</em> <strong>string</strong><br>
The token obtained during the OAuth Flow.</p>

<p>return_to : <em>optional</em> <strong>string</strong><br>
The URL the end point will redirect to once the authentication is done. Default when unprovided is the user’s Dashboard.</p>

<h2 id="registration-product-integration">Registration Product Integration</h2>

<p>A <a href="http://example-rego-integration.herokuapp.com">sample application</a> has been
built to show one possible end to end third party registration scenario.
Source code for the application can be found on
<a href="https://github.com/everydayhero/example_registrations">GitHub</a>.
This application demonstrates:</p>

<ul>
  <li>authentication with EDH</li>
  <li>using the everydayhero API to create a supporter page and view
information on the campaign</li>
  <li>while still giving you ultimate control over your registration system</li>
</ul>

<p>For this type of integration you will need the following:</p>

<ul>
  <li>An OAuth2 application</li>
  <li>An API key</li>
  <li>Registering a third party integration application</li>
</ul>

<p>All of this can be obtained by emailing
<a href="mailto:api@everydayhero.com">support</a>.</p>

<p>Generally there are going to be two entry points into your campaign, the
first will be through your website and the second will be through an
everydayhero supporter page. The two flows are slightly different and
deserve separate discussions.</p>


        
      </div>
    </section>
  </section>
  <script src="/javascripts/jquery.js"></script>
  <script src="/javascripts/app.js"></script>
</body>
</html>
